attributes.default:

  domain: my127.site
  
  hostname: = @('namespace') ~ '.' ~ @('domain')

  app:
    services: []
    image: node:14-slim
    build:
      steps:
      - run yarn install

  docker-compose:
    file_version: '3'
    sync:
      strategy: = @('host.os') == 'darwin' && @('app.dynamic') == 'yes' ? 'mutagen':'native'
      native:
        options: cached
      mutagen: ~

  jenkins:
    credentials:
      my127ws_key: = @('workspace.name') ~ '-my127ws-key'
    stage:
      publish:
        enabled: no
        services: = publishable_services(@('services'))
        chart:
          enabled: no
          git:
            ssh_private_key: ~
            repository: ~
            path: = 'build-artifacts/' ~ @('workspace.name')
            email: name@example.com

  docker:
    registry:
      url: = get_docker_registry(@('docker.repository'))
      username: = @('docker.username')
      password: = @('docker.password')
    repository: = @("workspace.name")

  git:
    main_branch: develop

  helm:
    image_pull_config: = docker_config(@('docker.registry'))
    additional_schema_locations: https://inviqa.github.io/kubernetes-json-schema/schema

    feature:
      sealed_secrets: true

    sealed_secrets:
      controller:
        name: sealed-secrets
        namespace: sealed-secrets
